(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{128:function(e,t,n){"use strict";n.r(t);var r=n(14),o=n(8),c=n(15);function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var a=void 0,s=void 0,d=[],f=function(e){switch(e.type){case"DOMContentLoaded":return"page view";case"activity:ping":return"page activity ping";case"beforeunload":return"page closed";case"editor:focus":return"start editing code";case"guide:submission:passed":return"passed code submission";case"guide:submission:sent":return"submitted code";case"pagefocus":return"page focus";case"pageoutoffocus":return"page out of focus";case"quiz:started":return"quiz started";case"quiz:submitted":return"quiz submitted";case"turbolinks:load":return"page view";case"videojs:end":case"videojs:pause":return"video stopped";case"videojs:play":return"video started";default:return e.type}},p=function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Array.from(document.querySelectorAll(".analytics-param")).reduce((function(e,t){return Object.assign(e,u({},t.dataset.key,t.dataset.value))}),{}),{type:f(e)})},l=function(e){var t=(new Date).getTime();(s||0)<t&&document.hasFocus()&&(document.dispatchEvent(new Event("activity:ping")),s=t+6e4)},v=function(e){d.push(p(e)),function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;if(a)for(var n;n=d.shift();)a.push("insert",n).receive("error",(function(e){Object(o.a)(e,c.a)}));else t<=120?window.setTimeout((function(){e(t+1)}),1e3):console.error("Tracking is not available",JSON.stringify(n))}()};document.addEventListener("DOMContentLoaded",(function(){return Object(c.b)("tracking:events",(function(e){void 0!=a&&(a.leave(),a=void 0),a=e}))})),document.addEventListener("activity:ping",v),document.addEventListener("editor:focus",v),document.addEventListener("guide:submission:passed",v),document.addEventListener("guide:submission:sent",v),document.addEventListener("pagefocus",v),document.addEventListener("pageoutoffocus",v),document.addEventListener("quiz:started",v),document.addEventListener("quiz:submitted",v),document.addEventListener("videojs:end",v),document.addEventListener("videojs:pause",v),document.addEventListener("videojs:play",v),window.addEventListener("beforeunload",v),"undefined"!=typeof r&&r.supported?document.addEventListener("turbolinks:load",v):document.addEventListener("DOMContentLoaded",v),document.addEventListener("visibilitychange",(function(e){document.hidden?document.dispatchEvent(new Event("pageoutoffocus")):document.dispatchEvent(new Event("pagefocus"))})),document.addEventListener("click",l),document.addEventListener("keydown",l),document.addEventListener("mousemove",l),document.addEventListener("mouseup",l),document.addEventListener("touchstart",l),document.addEventListener("wheel",l)},15:function(e,t,n){"use strict";n.d(t,"a",(function(){return O})),n.d(t,"b",(function(){return j}));var r=n(6),o=n.n(r),c=n(24),i=n(8);function u(e,t,n,r,o,c,i){try{var u=e[c](i),a=u.value}catch(s){return void n(s)}u.done?t(a):Promise.resolve(a).then(r,o)}function a(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var c=e.apply(t,n);function i(e){u(c,r,o,i,a,"next",e)}function a(e){u(c,r,o,i,a,"throw",e)}i(void 0)}))}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e){return function(){var t,n=w(e);if(m()){var r=w(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return f(this,t)}}function f(e,t){return!t||"object"!==typeof t&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function p(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&b(e,t)}function l(e){var t="function"===typeof Map?new Map:void 0;return(l=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!==typeof e)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return v(e,arguments,w(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),b(r,e)})(e)}function v(e,t,n){return(v=m()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&b(o,n.prototype),o}).apply(null,arguments)}function m(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function b(e,t){return(b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function w(e){return(w=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}document._trackingSocket=void 0;var y=!1,g=1e3,h=!1;window.addEventListener("beforeunload",(function(){return y=!0}));var O=function(e){p(n,e);var t=d(n);function n(e){var r;return s(this,n),(r=t.call(this,e)).name="TrackingChannelError",r}return n}(l(Error)),k=function(e){p(n,e);var t=d(n);function n(e,r){var o;return s(this,n),(o=t.call(this,r)).name="TrackingConnectionError: ".concat(e),o}return n}(l(Error)),E=function(){var e=a(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,t){document._trackingSocket?"function"==typeof document._trackingSocket.isConnected&&document._trackingSocket.isConnected()?(h=!1,g=1e3,e(document._trackingSocket)):window.setTimeout((function(){E().then((function(t){return e(t)})).catch((function(e){return t(e)}))}),1e3):(document._trackingSocket={},new Promise((function(e,t){var n=new XMLHttpRequest,r=function(e){return function(){n.onload=null,n.onreadystatechange=null,n.abort(),t(new k("Socket Connection Details Request ".concat(e),"Request has been cancelled"))}},o=r("Cancelled");n.open("POST","/api/tracking_token"),n.withCredentials=!0,n.setRequestHeader("Content-Type","application/json");var c=window.setTimeout(r("Timeout"),1e4);n.onload=function(){if(200===n.status){var r=JSON.parse(n.response);e(r)}else{var o=n.responseText||"Request failed",c=n.statusText||"Error",i="Socket Connection Details Request ".concat(c);t(new k(i,o))}},n.onreadystatechange=function(){4===n.readyState&&(window.clearTimeout(c),window.removeEventListener("beforeunload",o),0===n.status)&&t(new k("Socket Connection Details Request Rejection","Request failed prematurely"))},window.addEventListener("beforeunload",o),n.send()})).then((function(n){var r=n.socketUrl,o=n.token;document._trackingSocket=new c.Socket(r,{params:{token:o}}),document._trackingSocket.onError((function(e){return t(e)})),document._trackingSocket.onClose((function(){document._trackingSocket.disconnect(),document._trackingSocket=void 0,window.setTimeout(E,g)})),document._trackingSocket.connect(),E().then((function(t){return e(t)}))})).catch((function(n){if(y)console.warn(n),t(n);else{var r=!n.name.includes("Unauthorized"),o="Request failed prematurely"!==n.message,c="Request has been cancelled"===n.message;!h&&r&&o&&!c?(Object(i.a)(n),h=!0):console.error(n),document._trackingSocket=void 0,g*=2,window.setTimeout((function(){E().then((function(t){return e(t)})).catch((function(e){return t(e)}))}),g)}})))})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),j=function(){var e=a(o.a.mark((function e(t,n){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){E().then(function(){var r=a(o.a.mark((function r(c){var i;return o.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:(i=c.channel(t,{})).join().receive("ok",(function(){n(i),e(i)})),c.onClose((function(){return j(t,n)}));case 3:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}()).catch((function(){window.setTimeout((function(){j(t,n).then((function(t){return e(t)}))}),g)}))})));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},8:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return f}));var r=n(13);function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var u={user_id:document.currentUserId,camper_id:document.currentCamperId,subdomain:document.currentSubdomain},a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return s.sendError(e,c({},u,{},t,{location:window.location.href}))},s=new r.a({key:"a1b2e86b-4c3e-4b7e-b603-591b394ae6f8",revision:"dd177ae8352693ec362b5a650b0a0395aeccfcfc"}),d=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Error;e instanceof Error?a(e):void 0===e?a(new t("No message given")):"string"===typeof e.message?a(new t(e.message),{rawError:e}):"string"===typeof e?a(new t(e)):a(new t("Unknown message shape"),{rawError:e})},f=function(e,t){return s.wrap(e,c({},u,{},t))}}},[[128,12,1,2]]]);
//# sourceMappingURL=learning_analytics.75074757a01e22b77a55.chunk.js.map